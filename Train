from ultralytics import YOLO
import torch

DATA_YAML = r"C:/Users/c.prashant/Desktop/deco_dataset/data.yaml"

def main():
    print("Torch:", torch.__version__)
    print("CUDA:", torch.cuda.is_available())

    model = YOLO("yolov8n.pt")

    model.train(
        data=DATA_YAML,
        epochs=100,
        imgsz=640,
        batch=8,
        workers=0,      # IMPORTANT for Windows
        device="cpu",   # use "cuda" only if GPU is stable
        project="deco_training",
        name="deco_color_model",
        verbose=True
    )

    print("âœ… Training finished")

if __name__ == "__main__":
    main()
